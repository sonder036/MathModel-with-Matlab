## 评价类算法

### 层次分析法----AHP

主要用于解决评价类问题（例如：选择哪种方案最好、哪位运动员或者员工表现的更优秀）。

1. 建立评价体系
2. 建立判断矩阵并计算
3. 对判断矩阵进行一致性检验
  - 计算一致性指标
  - 查找对应的平均随机一致性指标$CI$
  - 计算一致性比例 $CR=\frac{CI}{RI}$
  - 计算权重

```matlab
A=input('输入判断矩阵:');                % 输入判断矩阵
%% 计算一致性比例CR
n=size(A,1);                            %求出判断矩阵阶数
[V,D]=eig(A);                           %求出特征值和特征向量
Max_eig=max(D(:));                      %找出最大特征值
CI=(Max_eig-n)/(n-1);                   %计算一致性指标
RI=[0 0 0.52 0.89 1.12 1.26 1.36];      %列出平均随机一致性指标
CR=CI/RI(n);                            %求出一致性比例
if(CR<0.1)                              %判断一致性是否能接受
    disp("一致性可以接受!");
else
    disp("一致性检验未通过，需要修改判断矩阵!");
end
%% 方法一：算数平均法求权重
Product_A=sum(A,2);                    %将判断矩阵每行相乘
Product_n_A=Product_A./n;              %求几何平均值
w_ari=Product_n_A./sum(Product_n_A);   %将其标准化
disp('算数平均值值法求权重结果为:');     %输出结果
disp(w_ari);    
%% 方法二：几何平均法求权重
Product_B=prod(A,2);                    %将判断矩阵每行相乘
Product_n_B=Product_B.^(1/n);           %求几何平均值
w_geo=Product_n_B./sum(Product_n_B);    %将其标准化
disp('几何平均值值法求权重结果为:');      %输出结果
disp(w_geo);             
%% 方法三：特征值法求权重
[r,c]=find(D==Max_eig,1);               %找到最大特征值的位置
w_eig=V(:,c)./sum(V(:,c));              %找到相应的特征向量，并将其标准化
disp('特征值法求权重结果为:');            %输出结果
disp(w_eig); 
```

### 优劣解距离法----TOPSIS

TOPSIS 法是一种常用的综合评价方法，其能充分利用原始数据的信息， 其结果能精确地反映各评价方案之间的差距

```matlab
%%步骤一：读取数据  
clear;clc  
load data_water_quality.mat                      %读取数据  
[r,c]=size(X);  
disp('····················读取数据成功····················');  
disp(['评价对象数量为：',num2str(r)]);  
disp(['评价指标数量为：',num2str(c)]);  
%%步骤二：对指标进行正向化处理  
disp('····················进行正向化处理····················');  
Type=input('请按顺序输入各列指标类型：1.极大型 2.极小型 3.中间型 4.区间型:'); 
for i = 1:c  
    if Type(i)==1  
        disp(['第' num2str(i) '列是极大型，无需正向化'] );  
        disp('~~~~~~~~~~~~~~~~~~~~分界线~~~~~~~~~~~~~~~~~~~~');  
    elseif Type(i)==2  
        disp(['第' num2str(i) '列是极小型，进行正向化'] );  
        Maxx=max(X);                          %找出最大值  
        for j = 1:r                           %进行正向化  
            X(j,i)=Maxx(i)-X(j,i);  
        end  
        disp('~~~~~~~~~~~~~~~~~~~~分界线~~~~~~~~~~~~~~~~~~~~');  
    elseif Type(i)==3  
        disp(['第' num2str(i) '列是中间型，进行正向化'] );  
        best=input('请输入最优值：');                                       %7  
        M=max(abs(X(:,i)-best));             %找出距离最优值最远距离  
        for j = 1:r                          %进行正向化  
            X(j,i)=1-abs(X(j,i)-best)/M;  
        end  
        disp('~~~~~~~~~~~~~~~~~~~~分界线~~~~~~~~~~~~~~~~~~~~');  
    elseif Type(i)==4  
        disp(['第' num2str(i) '列是区间型，进行正向化'] );  
        L=input('请输入最优区间下界：');                                    %10  
        R=input('请输入最优区间上界：');                                    %20  
        M=0;  
        for j = 1:r                         %找出距离最优区间最远距离  
            if X(j,i)<L  
                M=max(M,L-X(j,i));  
            elseif X(j,i)>R  
                M=max(M,X(j,i)-R);  
            end  
        end    
        for j = 1:r                         %进行正向化  
            if X(j,i)<L  
                X(j,i)=1-(L-X(j,i))/M;  
            elseif X(j,i)>R  
                X(j,i)=1-(X(j,i)-R)/M;  
            else  
                X(j,i)=1;  
            end  
        end    
        disp('~~~~~~~~~~~~~~~~~~~~分界线~~~~~~~~~~~~~~~~~~~~');  
    else  
        disp('没有预设处理该类型的指标，请检查输入是否正确。');  
    end  
end  
disp('····················正向化处理完成····················');  
disp('··················正向化处理后矩阵为···················');  
disp(X);  
%%步骤三：处理指标权重  
judge_flag=input('如果需要对指标加入权重输入1，否则输入0：');            %0  
if judge_flag==1  
    weight=input('请按顺序输入每个指标的权重(注意权重和应为1)：');             %[0.2,0.2,0.3,0.3]  
    flag=0;  
    while flag==0                               %判断指标权重是否合法 
        if(abs(sum(weight)-1)<0.0000001 && size(weight,1)==1 && size(weight,2)==c )  
            flag=1;  
        else  
            weight=input('输入有误，请重新输入：');  
        end  
    end  
else  
    weight=ones(1,c)./c;  
end  
%%步骤四：化为标准化矩阵  
disp('··················标准化处理后矩阵为···················');  
Z=X./repmat(sum(X.*X) .^ 0.5,r,1);              %将矩阵标准化处理  
disp(Z);  
%%步骤五：计算得分  
D_max=sum([ (Z - repmat(max(Z),r,1)) .^ 2 ] .* repmat(weight,r,1) ,2) .^0.5;  
D_min=sum([ (Z - repmat(min(Z),r,1)) .^ 2 ] .* repmat(weight,r,1) ,2) .^0.5;  
Grade=D_min./(D_max+D_min);                     %计算出未归一化得分  
Grade=Grade./sum(Grade);                        %将得分归一化  
```

### 模糊综合评价

#### 概述

	生活中处处存在模糊性，与确定性相对。如性别，身高，体重等定量概念是确定性概念；而帅，高，年轻等概念为模糊性概念。
	
	模糊数学⼜称 Fuzzy 数学，是研究和处理模糊性现象的⼀种数学理论和⽅法。模糊性数学发展的主流是在它的应⽤⽅⾯。 由于模糊性概念已经找到了模糊集的描述⽅式，⼈们运⽤概念进⾏判断、评价、推理、决策和控制的过程也可以⽤模糊性数 学的⽅法来描述。例如模糊聚类分析、模糊模式识别、模糊综合评判、模糊决策与模糊预测、模糊控制、模糊信息处理等。 这些⽅法构成了⼀种模糊性系统理论，构成了⼀种思辨数学的雏形，它已经在医学、⽓象、⼼理、经济管理、⽯油、地质、 环境、⽣物、农业、林业、化⼯、语⾔、控制、遥感、教育、体育等⽅⾯取得具体的研究成果。

#### 经典集合和模糊集合的基本概念

1. 经典集合和特征函数

   经典集合承认非此即彼，用特征函数刻画经典集合。
   $$
   f_A:\Omega \to \{ 0,1 \}\\
   \Omega: 论域（讨论对象的集合）\\
   f_A 表示A集合的特征函数\\
   f_A=
   \begin{cases}
    1\ \ \ x\in A \\
    0\ \ \ x\notin A
   \end{cases}
   \ \ \ \ \forall x \in \Omega
   $$

2. 模糊集合和隶属函数

   模糊结合承认亦此亦彼，用隶属函数刻画模糊集合。
   $$
   u_A:\Omega \to [ 0,1 ]\\
   \Omega: 论域（讨论对象的集合）\\
   u_A 表示A集合的隶属函数，值对应隶属度\\
   $$
   表示方法：
   $$
   论域\ \ \Omega =\{x_1,x_2,...x_n \},\ 模糊集合为\ A,\ 隶属度为\ A(x_i),\ i=1,2,...,n\\
   Zadeh表示法:\ A=\sum^{n}_{i=1} \frac{A(x_i)}{x_i}\\
   序偶表示法:\ A=\{(x_1,A(x_1)),(x_2,A(x_2)),...,(x_n,A(x_n))\}
   $$

##### 隶属函数的确定方法

1. 借助已有的客观尺度 (需要有合适的指标，并能收收集到数据)

   这里找到的指标必须归一化，下面是一些例子。

   | 论域 | 模糊集   | 隶属度     |
   | ---- | -------- | ---------- |
   | 设备 | 设备完好 | 设备完好率 |
   | 产品 | 质量稳定 | 良品率     |
   | 家庭 | 小康家庭 | 恩格尔系数 |
   
2. 指派法

   根据问题的性质直接套⽤某些分布 作为⾪属函数，主观性较强，优点是比较方便。

![image-20240129202442569](.\image-20240129202442569.png)

##### 模糊综合评价问题概述

		模糊评价问题是要把论域中的对象对应评语集中⼀个指定的评语或者将⽅案作为评语集并选择⼀个最优的⽅案。

在模糊综合评价中引⼊了三个集合：

- 因素集（评价指标集）：$\Omega = \{u_1,u_2,...,u_n\}$
- 评语集（评价的结果）：$V = \{v_1,v_2,...,v_n\}$
- 权重集（指标的权重）：$A = \{a_1,a_2,...,a_n\}$

例如要评价一名学生的表现：

- 因素集：$\Omega = \{专业排名,\ 科研竞赛,\ 志愿活动,\ 课外实践\}$
- 评语集：$V = \{优\ 良\ 差\}$
- 权重集：$A = \{0.5,\ 0.3,\ 0.1,\ 0.1\}$

一级模糊综合评判模型的建立，主要包括以下步骤：

1. 确立因素集
2. 确立评语集
3. 确定各因素的权重
4. 确定模糊综合判断矩阵
5. 综合评判